<h1>Welcome, <%=current_user.name%>!</h1>

<%=show_users_path_if_admin%>

<% if(@plans_for_today.present?)%>
	<%if Time.now.hour > 06 %>
		Check off the things you accomplished today. Don't worry, there's always tomorrow for plans you couldn't achieve today!
		<% @plans_for_today.each do |plan|%>
		<br>
			<input type="checkbox" id="checkbox-users-show" onclick="sendCheckRequest(<%=plan.id%>)">
			<%=plan.ambition%>
		<%end%>
	<%else%>
		<h5>Your plans have been added. Get to work!</h5>
	<%end%>
<%else%>
	<%=form_for(:plan, url: plans_path) do |f| %>
		<div class = "form-group">
			<%=f.label "What do you plan to learn today? (You can add plans till 6 pm today)"%>
			<%=f.text_area :ambition, id: "ambition-form-field", class: "form-control"%>
		</div>
		<p style="color:#f44336">
			<%=18-Time.now.hour%> hour(s) left to achieve your goals!
		</p>
		<%=f.submit "Add Plan", class: "btn btn-primary"%>
	<%end%>
<%end%>
<br>

<p>
	<h3>Here's what your history looks like</h3>
</p>
<table class = "table">
	<tr>
		<th>
			Date
		</th>
		<th>
			Plan
		</th>
		<th>
			Accomplishment
		</th>
	</tr>
	<% @dates.each do |date| %>
		<tr >
			<td>
				<%=date%>
			</td>
			<td>
				<%@plans.where(date: date).each do |plan|%> 
					<%=plan.ambition%> <br>
				<%end%>
			</td>
			<td>
				
			</td>
		</tr>
	<%end%>
</table>
<script type="text/javascript">
	function sendCheckRequest(planId){
		console.log("Logged plan ID "+planId);
		$.ajax({
			url: '../insert_checkbox',
			type: "GET",
			data: {'plan_id': planId},
			dataType: "json",
			success: function(data){
				alert("Success");
			},
			error: function(data){
				alert('Failure');
				console.log(data.responseText);
			}
	});
}
</script>